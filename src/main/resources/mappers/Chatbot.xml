<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.goldensnitch.qudditch.mapper.ChatbotMapper">

    <!--상품의 가격을 물어보는 챗봇-->
    <select id="price" resultType="Chatbot" parameterType="String">
        SELECT name, price
        FROM product
        WHERE name like concat('%',#{productName},'%')
    </select>

    <!--검색한 상품이 있는 가게 리스트 챗봇-->
    <select id="store" resultType="ChatbotStore" parameterType="String">
        select s.name
        from store s
                 Join user_store u ON s.id = u.store_id
        where u.id =any(select ss.user_store_id
                        from product p
                                 Join store_stock ss ON p.id = ss.product_id
                        where p.name like concat('%',#{name},'%'));
    </select>

</mapper>