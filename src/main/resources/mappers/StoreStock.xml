<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goldensnitch.qudditch.mapper.StoreStockMapper">
    <select id="cntAllProductByUserStoreId" parameterType="int" resultType="int">
        SELECT COUNT(*) FROM store_stock WHERE user_store_id = #{userStoreId}
    </select>
    <select id="selectAllProductByUserStoreId" parameterType="int" resultType="StoreStockRes">
        SELECT s.*, c.name as categoryName, p.name as productName, p.brand as brand, p.image as productImage, p.price as productPrice
        FROM store_stock s , product p, category c
        WHERE user_store_id = #{userStoreId} and s.product_id = p.id and p.category_id = c.id
    </select>
    <select id="selectProductByUserStoreIdAndProductId" parameterType="StoreStock" resultType="StoreStock">
        SELECT * FROM store_stock WHERE user_store_id = #{userStoreId} and product_id = #{productId}
    </select>
    <update id="updateStock" parameterType="StoreStock">
        UPDATE store_stock
        SET qty = #{qty}, position_id = #{positionId}
        WHERE user_store_id = #{userStoreId} and product_id = #{productId}
    </update>
    <select id="selectProductByUserStoreIdAndCategoryId">
        SELECT s.*, c.name as categoryName, p.name as productName, p.brand as brand, p.image as productImage, p.price as productPrice
        FROM store_stock s , product p, category c
        WHERE user_store_id = #{userStoreId} and s.product_id = p.id and p.category_id = c.id and p.category_id = #{categoryId}
    </select>



</mapper>